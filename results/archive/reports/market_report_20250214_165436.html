
            <!DOCTYPE html>
            <html>
            <head>
                <title>Market Analysis Report</title>
                <script src="https://code.jquery.com/jquery-3.7.0.min.js"></script>
                <script src="https://cdn.datatables.net/1.13.4/js/jquery.dataTables.min.js"></script>
                <link rel="stylesheet" href="https://cdn.datatables.net/1.13.4/css/jquery.dataTables.min.css">
                <style>
                    body { 
                        font-family: Arial, sans-serif; 
                        margin: 20px;
                        max-width: 1400px;
                        margin: 0 auto;
                        padding: 20px;
                    }
                    .dataTables_wrapper { margin-top: 20px; }
                    th { 
                        position: sticky; 
                        top: 0; 
                        background: white;
                        z-index: 10;
                    }
                    .dataTables_filter { margin-bottom: 10px; }
                    .sentiment-table { width: 100%; }
                    tr:hover { background-color: #f5f5f5 !important; }
                    .top-10:hover { background-color: #d6ffd6 !important; }
                    .bottom-10:hover { background-color: #ffd6d6 !important; }
                    .header-section {
                        margin-bottom: 20px;
                        display: flex;
                        justify-content: space-between;
                        align-items: center;
                    }
                    .legend span {
                        padding: 2px 8px;
                        margin-right: 10px;
                        border-radius: 3px;
                    }
                    .refresh-btn {
                        padding: 5px 10px;
                        cursor: pointer;
                        border-radius: 3px;
                        border: 1px solid #ddd;
                        background: white;
                    }
                    .refresh-btn:hover {
                        background: #f5f5f5;
                    }
                </style>
            </head>
            <body>
                <div class="header-section">
                    <h2>Market Analysis Report</h2>
                    <div>
                        <span>Generated: {datetime.now().strftime('%Y-%m-%d %H:%M:%S')}</span>
                        <button class="refresh-btn" onclick="window.location.reload()">Refresh</button>
                    </div>
                </div>
                
                <div class="legend">
                    <span style="background: #e6ffe6;">Top 10 Sentiment</span>
                    <span style="background: #ffe6e6;">Bottom 10 Sentiment</span>
                </div>

                <table id="sentiment-table" class="display">
                    <thead>
                        <tr>
                            <th>Ticker</th>
                            <th>Company</th>
                            <th>Last Week</th>
                            <th>15 Day</th>
                            <th>Last Month</th>
                            <th>Articles</th>
                            <th>Target Price</th>
                            <th>Potential Return</th>
                            <th>Analysts</th>
                            <th>Recommendation</th>
                        </tr>
                    </thead>
                    <tbody>
            
                    <tr style="background-color: #e6ffe6;">
                        <td>AAPL</td>
                        <td>Apple Inc.</td>
                        <td> ðŸ†•</td>
                        <td> ðŸ†•</td>
                        <td> ðŸ†•</td>
                        <td>245</td>
                        <td>$257.50</td>
                        <td>5.8%</td>
                        <td>40</td>
                        <td>BUY</td>
                    </tr>
                
                    <tr style="background-color: #e6ffe6;">
                        <td>AMZN</td>
                        <td>Amazon.com Inc.</td>
                        <td> ðŸ†•</td>
                        <td> ðŸ†•</td>
                        <td> ðŸ†•</td>
                        <td>248</td>
                        <td>$270.00</td>
                        <td>18.2%</td>
                        <td>64</td>
                        <td>STRONG_BUY</td>
                    </tr>
                
                    <tr style="background-color: #e6ffe6;">
                        <td>GOOGL</td>
                        <td>Alphabet Inc.</td>
                        <td> ðŸ†•</td>
                        <td> ðŸ†•</td>
                        <td> ðŸ†•</td>
                        <td>245</td>
                        <td>$220.00</td>
                        <td>18.6%</td>
                        <td>48</td>
                        <td>BUY</td>
                    </tr>
                
                    <tr style="background-color: #e6ffe6;">
                        <td>JNJ</td>
                        <td>Johnson & Johnson</td>
                        <td> ðŸ†•</td>
                        <td> ðŸ†•</td>
                        <td> ðŸ†•</td>
                        <td>98</td>
                        <td>$166.00</td>
                        <td>6.0%</td>
                        <td>21</td>
                        <td>BUY</td>
                    </tr>
                
                    <tr style="background-color: #e6ffe6;">
                        <td>JPM</td>
                        <td>JPMorgan Chase & Co.</td>
                        <td> ðŸ†•</td>
                        <td> ðŸ†•</td>
                        <td> ðŸ†•</td>
                        <td>166</td>
                        <td>$273.00</td>
                        <td>-1.7%</td>
                        <td>21</td>
                        <td>BUY</td>
                    </tr>
                
                    <tr style="background-color: #e6ffe6;">
                        <td>META</td>
                        <td>Meta Platforms Inc.</td>
                        <td> ðŸ†•</td>
                        <td> ðŸ†•</td>
                        <td> ðŸ†•</td>
                        <td>249</td>
                        <td>$772.50</td>
                        <td>5.5%</td>
                        <td>60</td>
                        <td>STRONG_BUY</td>
                    </tr>
                
                    <tr style="background-color: #e6ffe6;">
                        <td>MSFT</td>
                        <td>Microsoft Corporation</td>
                        <td> ðŸ†•</td>
                        <td> ðŸ†•</td>
                        <td> ðŸ†•</td>
                        <td>250</td>
                        <td>$500.00</td>
                        <td>22.7%</td>
                        <td>50</td>
                        <td>STRONG_BUY</td>
                    </tr>
                
                    <tr style="background-color: #e6ffe6;">
                        <td>NVDA</td>
                        <td>NVIDIA Corporation</td>
                        <td> ðŸ†•</td>
                        <td> ðŸ†•</td>
                        <td> ðŸ†•</td>
                        <td>249</td>
                        <td>$175.00</td>
                        <td>26.8%</td>
                        <td>54</td>
                        <td>STRONG_BUY</td>
                    </tr>
                
                    <tr style="background-color: #e6ffe6;">
                        <td>TSLA</td>
                        <td>Tesla Inc.</td>
                        <td> ðŸ†•</td>
                        <td> ðŸ†•</td>
                        <td> ðŸ†•</td>
                        <td>250</td>
                        <td>$359.00</td>
                        <td>1.7%</td>
                        <td>42</td>
                        <td>HOLD</td>
                    </tr>
                
                    <tr style="background-color: #e6ffe6;">
                        <td>V</td>
                        <td>Visa Inc.</td>
                        <td> ðŸ†•</td>
                        <td> ðŸ†•</td>
                        <td> ðŸ†•</td>
                        <td>85</td>
                        <td>$385.00</td>
                        <td>8.5%</td>
                        <td>36</td>
                        <td>BUY</td>
                    </tr>
                
                    </tbody>
                </table>
                <script>
                    $(document).ready(function() {
                        $('#sentiment-table').DataTable({
                            order: [[4, 'desc']],  // Sort by last month sentiment by default
                            pageLength: 25,
                            fixedHeader: true,
                            scrollY: '70vh',
                            scrollCollapse: true,
                            keys: true,  // Enable keyboard navigation
                            initComplete: function() {
                                // Focus search box with Ctrl+F
                                $(document).keydown(function(e) {
                                    if (e.ctrlKey && e.keyCode == 70) {
                                        e.preventDefault();
                                        $('.dataTables_filter input').focus();
                                    }
                                });
                            }
                        });
                    });
                </script>
            </body>
            </html>
            