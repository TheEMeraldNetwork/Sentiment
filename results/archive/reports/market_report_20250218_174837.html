
            <!DOCTYPE html>
            <html>
            <head>
                <title>Market Analysis Report</title>
                <script src="https://code.jquery.com/jquery-3.7.0.min.js"></script>
                <script src="https://cdn.datatables.net/1.13.4/js/jquery.dataTables.min.js"></script>
                <link rel="stylesheet" href="https://cdn.datatables.net/1.13.4/css/jquery.dataTables.min.css">
                <style>
                    body { 
                        font-family: Arial, sans-serif; 
                        margin: 20px;
                        max-width: 1400px;
                        margin: 0 auto;
                        padding: 20px;
                    }
                    .dataTables_wrapper { margin-top: 20px; }
                    th { 
                        position: sticky; 
                        top: 0; 
                        background: white;
                        z-index: 10;
                        text-align: left;
                    }
                    td.number {
                        text-align: right;
                        padding-right: 15px !important;
                    }
                    td.text {
                        text-align: left;
                    }
                    .dataTables_filter { margin-bottom: 10px; }
                    .sentiment-table { width: 100%; }
                    tr:hover { background-color: #f5f5f5 !important; }
                    .header-section {
                        margin-bottom: 20px;
                        display: flex;
                        justify-content: space-between;
                        align-items: center;
                    }
                    .funnel-section {
                        background: #f8f9fa;
                        padding: 20px;
                        border-radius: 8px;
                        margin-bottom: 30px;
                    }
                    .funnel-grid {
                        display: grid;
                        grid-template-columns: repeat(3, 1fr);
                        gap: 20px;
                        margin-top: 15px;
                    }
                    .funnel-item {
                        background: white;
                        padding: 15px;
                        border-radius: 6px;
                        box-shadow: 0 2px 4px rgba(0,0,0,0.05);
                    }
                    .funnel-number {
                        font-size: 24px;
                        font-weight: bold;
                        color: #2c3e50;
                    }
                    .funnel-label {
                        font-size: 14px;
                        color: #666;
                        margin-top: 5px;
                    }
                    .legend span {
                        padding: 2px 8px;
                        margin-right: 10px;
                        border-radius: 3px;
                    }
                    .refresh-btn {
                        padding: 5px 10px;
                        cursor: pointer;
                        border-radius: 3px;
                        border: 1px solid #ddd;
                        background: white;
                    }
                    .refresh-btn:hover {
                        background: #f5f5f5;
                    }
                    .section-header {
                        margin-top: 30px;
                        margin-bottom: 10px;
                        font-size: 1.2em;
                        color: #333;
                    }
                    .trend-symbol {
                        font-weight: bold;
                        margin-left: 4px;
                    }
                    .trend-up { color: green; }
                    .trend-down { color: red; }
                    .trend-stable { color: gray; }
                    .trend-new { color: blue; }
                </style>
            </head>
            <body>
                <div class="header-section">
                    <h2>Market Analysis Report</h2>
                    <div>
                        <span>Generated: {datetime.now().strftime('%Y-%m-%d %H:%M:%S')}</span>
                        <button class="refresh-btn" onclick="window.location.reload()">Refresh</button>
                    </div>
                </div>

                <div class="funnel-section">
                    <h3>Data Processing Funnel</h3>
                    <div class="funnel-grid">
                        <div class="funnel-item">
                            <div class="funnel-number">{funnel_stats['total_stocks']}</div>
                            <div class="funnel-label">Total Stocks Tracked</div>
                        </div>
                        <div class="funnel-item">
                            <div class="funnel-number">{funnel_stats['stocks_with_news']}</div>
                            <div class="funnel-label">Stocks with News</div>
                        </div>
                        <div class="funnel-item">
                            <div class="funnel-number">{funnel_stats['total_articles']:.0f}</div>
                            <div class="funnel-label">Total Articles Processed</div>
                        </div>
                        <div class="funnel-item">
                            <div class="funnel-number">{funnel_stats['stocks_with_sentiment']}</div>
                            <div class="funnel-label">Stocks with Sentiment</div>
                        </div>
                        <div class="funnel-item">
                            <div class="funnel-number">{funnel_stats['stocks_with_market']}</div>
                            <div class="funnel-label">Stocks with Market Data</div>
                        </div>
                        <div class="funnel-item">
                            <div class="funnel-number">{funnel_stats['stocks_with_complete']}</div>
                            <div class="funnel-label">Stocks with Complete Data</div>
                        </div>
                    </div>
                </div>
                
                <div class="legend">
                    <span style="background: #e6ffe6;">Top Sentiment</span>
                    <span style="background: #ffe6e6;">Bottom Sentiment</span>
                    <span>Trend: U (Up), D (Down), S (Stable), N (New)</span>
                </div>

                <div class="section-header">Stocks with Complete Data</div>
                <table id="sentiment-table" class="display">
                    <thead>
                        <tr>
                            <th>Ticker</th>
                            <th>Company</th>
                            <th>Last Week</th>
                            <th>Last Month</th>
                            <th>Articles</th>
                            <th>Target Price</th>
                            <th>Potential Return</th>
                            <th>Analysts</th>
                            <th>Recommendation</th>
                            <th>Sentiment Change</th>
                            <th>Trend</th>
                        </tr>
                    </thead>
                    <tbody>
            
                    <tr>
                        <td class="text">AMTM</td>
                        <td class="text">Amentum Holdings Inc.</td>
                        <td class="number"></td>
                        <td class="number">0.23 <span class='trend-symbol trend-new'>N</span></td>
                        <td class="number">2</td>
                        <td class="number">$27.50</td>
                        <td class="number">27.7%</td>
                        <td class="number">4</td>
                        <td class="text">BUY</td>
                        <td class="number"></td>
                        <td class="text"></td>
                    </tr>
                
                    <tr>
                        <td class="text">AMZN</td>
                        <td class="text">Amazon.com Inc.</td>
                        <td class="number">0.06 <span class='trend-symbol trend-new'>N</span></td>
                        <td class="number">-0.04 <span class='trend-symbol trend-new'>N</span></td>
                        <td class="number">248</td>
                        <td class="number">$270.00</td>
                        <td class="number">20.2%</td>
                        <td class="number">64</td>
                        <td class="text">STRONG_BUY</td>
                        <td class="number"></td>
                        <td class="text"></td>
                    </tr>
                
                    <tr>
                        <td class="text">ARCO</td>
                        <td class="text">Arcos Dorados Holdings Inc.</td>
                        <td class="number">0.00 <span class='trend-symbol trend-new'>N</span></td>
                        <td class="number">0.00 <span class='trend-symbol trend-new'>N</span></td>
                        <td class="number">5</td>
                        <td class="number">$10.75</td>
                        <td class="number">28.6%</td>
                        <td class="number">8</td>
                        <td class="text">BUY</td>
                        <td class="number"></td>
                        <td class="text"></td>
                    </tr>
                
                    <tr>
                        <td class="text">ASTH</td>
                        <td class="text">Astrana Health Inc.</td>
                        <td class="number"></td>
                        <td class="number">0.46 <span class='trend-symbol trend-new'>N</span></td>
                        <td class="number">2</td>
                        <td class="number">$66.00</td>
                        <td class="number">69.3%</td>
                        <td class="number">10</td>
                        <td class="text">STRONG_BUY</td>
                        <td class="number"></td>
                        <td class="text"></td>
                    </tr>
                
                    <tr>
                        <td class="text">AVGO</td>
                        <td class="text">Broadcom Inc.</td>
                        <td class="number">0.13 <span class='trend-symbol trend-new'>N</span></td>
                        <td class="number">0.05 <span class='trend-symbol trend-new'>N</span></td>
                        <td class="number">191</td>
                        <td class="number">$250.00</td>
                        <td class="number">10.1%</td>
                        <td class="number">37</td>
                        <td class="text">STRONG_BUY</td>
                        <td class="number"></td>
                        <td class="text"></td>
                    </tr>
                
                    <tr>
                        <td class="text">AXON</td>
                        <td class="text">Axon Enterprise Inc.</td>
                        <td class="number">0.82 <span class='trend-symbol trend-new'>N</span></td>
                        <td class="number">0.25 <span class='trend-symbol trend-new'>N</span></td>
                        <td class="number">32</td>
                        <td class="number">$660.65</td>
                        <td class="number">-6.4%</td>
                        <td class="number">16</td>
                        <td class="text">STRONG_BUY</td>
                        <td class="number"></td>
                        <td class="text"></td>
                    </tr>
                
                    <tr>
                        <td class="text">BIIB</td>
                        <td class="text">Biogen Inc.</td>
                        <td class="number">0.01 <span class='trend-symbol trend-new'>N</span></td>
                        <td class="number">0.08 <span class='trend-symbol trend-new'>N</span></td>
                        <td class="number">35</td>
                        <td class="number">$192.50</td>
                        <td class="number">40.9%</td>
                        <td class="number">30</td>
                        <td class="text">BUY</td>
                        <td class="number"></td>
                        <td class="text"></td>
                    </tr>
                
                    <tr>
                        <td class="text">BILL</td>
                        <td class="text">BILL Holdings Inc.</td>
                        <td class="number"></td>
                        <td class="number">0.03 <span class='trend-symbol trend-new'>N</span></td>
                        <td class="number">18</td>
                        <td class="number">$88.00</td>
                        <td class="number">44.0%</td>
                        <td class="number">23</td>
                        <td class="text">BUY</td>
                        <td class="number"></td>
                        <td class="text"></td>
                    </tr>
                
                    <tr>
                        <td class="text">BRZE</td>
                        <td class="text">Braze Inc.</td>
                        <td class="number"></td>
                        <td class="number">0.19 <span class='trend-symbol trend-new'>N</span></td>
                        <td class="number">2</td>
                        <td class="number">$50.00</td>
                        <td class="number">22.6%</td>
                        <td class="number">18</td>
                        <td class="text">BUY</td>
                        <td class="number"></td>
                        <td class="text"></td>
                    </tr>
                
                    <tr>
                        <td class="text">CG</td>
                        <td class="text">Centerra Gold Inc.</td>
                        <td class="number"></td>
                        <td class="number">0.17 <span class='trend-symbol trend-new'>N</span></td>
                        <td class="number">9</td>
                        <td class="number">$55.00</td>
                        <td class="number">4.5%</td>
                        <td class="number">18</td>
                        <td class="text">BUY</td>
                        <td class="number"></td>
                        <td class="text"></td>
                    </tr>
                
                    <tr>
                        <td class="text">CHMI</td>
                        <td class="text">Cherry Hill Mortgage Investment Corporation</td>
                        <td class="number">0.30 <span class='trend-symbol trend-new'>N</span></td>
                        <td class="number">0.15 <span class='trend-symbol trend-new'>N</span></td>
                        <td class="number">2</td>
                        <td class="number">$4.00</td>
                        <td class="number">12.4%</td>
                        <td class="number">2</td>
                        <td class="text">NONE</td>
                        <td class="number"></td>
                        <td class="text"></td>
                    </tr>
                
                    <tr>
                        <td class="text">CIVI</td>
                        <td class="text">Civitas Resources Inc.</td>
                        <td class="number"></td>
                        <td class="number">0.00 <span class='trend-symbol trend-new'>N</span></td>
                        <td class="number">1</td>
                        <td class="number">$70.00</td>
                        <td class="number">37.7%</td>
                        <td class="number">16</td>
                        <td class="text">STRONG_BUY</td>
                        <td class="number"></td>
                        <td class="text"></td>
                    </tr>
                
                    <tr>
                        <td class="text">CLDX</td>
                        <td class="text">Celldex Therapeutics Inc.</td>
                        <td class="number"></td>
                        <td class="number">0.00 <span class='trend-symbol trend-new'>N</span></td>
                        <td class="number">1</td>
                        <td class="number">$68.00</td>
                        <td class="number">198.9%</td>
                        <td class="number">11</td>
                        <td class="text">STRONG_BUY</td>
                        <td class="number"></td>
                        <td class="text"></td>
                    </tr>
                
                    <tr>
                        <td class="text">CMPS</td>
                        <td class="text">COMPASS Pathways plc</td>
                        <td class="number"></td>
                        <td class="number">0.13 <span class='trend-symbol trend-new'>N</span></td>
                        <td class="number">3</td>
                        <td class="number">$15.00</td>
                        <td class="number">226.8%</td>
                        <td class="number">9</td>
                        <td class="text">STRONG_BUY</td>
                        <td class="number"></td>
                        <td class="text"></td>
                    </tr>
                
                    <tr>
                        <td class="text">COUR</td>
                        <td class="text">Coursera Inc.</td>
                        <td class="number"></td>
                        <td class="number">-0.01 <span class='trend-symbol trend-new'>N</span></td>
                        <td class="number">7</td>
                        <td class="number">$10.00</td>
                        <td class="number">18.1%</td>
                        <td class="number">12</td>
                        <td class="text">NONE</td>
                        <td class="number"></td>
                        <td class="text"></td>
                    </tr>
                
                    <tr>
                        <td class="text">CRM</td>
                        <td class="text">Salesforce Inc.</td>
                        <td class="number">-0.01 <span class='trend-symbol trend-new'>N</span></td>
                        <td class="number">0.03 <span class='trend-symbol trend-new'>N</span></td>
                        <td class="number">85</td>
                        <td class="number">$411.50</td>
                        <td class="number">25.4%</td>
                        <td class="number">46</td>
                        <td class="text">BUY</td>
                        <td class="number"></td>
                        <td class="text"></td>
                    </tr>
                
                    <tr>
                        <td class="text">CVE</td>
                        <td class="text">Cenovus Energy Ltd.</td>
                        <td class="number">0.32 <span class='trend-symbol trend-new'>N</span></td>
                        <td class="number">-0.01 <span class='trend-symbol trend-new'>N</span></td>
                        <td class="number">3</td>
                        <td class="number">$20.82</td>
                        <td class="number">35.2%</td>
                        <td class="number">3</td>
                        <td class="text">BUY</td>
                        <td class="number"></td>
                        <td class="text"></td>
                    </tr>
                
                    <tr>
                        <td class="text">DDOG</td>
                        <td class="text">Datadog Inc.</td>
                        <td class="number">-0.62 <span class='trend-symbol trend-new'>N</span></td>
                        <td class="number">-0.24 <span class='trend-symbol trend-new'>N</span></td>
                        <td class="number">16</td>
                        <td class="number">$160.00</td>
                        <td class="number">24.2%</td>
                        <td class="number">40</td>
                        <td class="text">BUY</td>
                        <td class="number"></td>
                        <td class="text"></td>
                    </tr>
                
                    <tr>
                        <td class="text">DHR</td>
                        <td class="text">Danaher Corporation</td>
                        <td class="number">0.13 <span class='trend-symbol trend-new'>N</span></td>
                        <td class="number">-0.03 <span class='trend-symbol trend-new'>N</span></td>
                        <td class="number">70</td>
                        <td class="number">$265.00</td>
                        <td class="number">29.9%</td>
                        <td class="number">25</td>
                        <td class="text">BUY</td>
                        <td class="number"></td>
                        <td class="text"></td>
                    </tr>
                
                    <tr>
                        <td class="text">DVN</td>
                        <td class="text">Devon Energy Corporation</td>
                        <td class="number">0.14 <span class='trend-symbol trend-new'>N</span></td>
                        <td class="number">0.02 <span class='trend-symbol trend-new'>N</span></td>
                        <td class="number">23</td>
                        <td class="number">$47.50</td>
                        <td class="number">35.1%</td>
                        <td class="number">30</td>
                        <td class="text">BUY</td>
                        <td class="number"></td>
                        <td class="text"></td>
                    </tr>
                
                    <tr>
                        <td class="text">DXCM</td>
                        <td class="text">DexCom Inc.</td>
                        <td class="number">0.00 <span class='trend-symbol trend-new'>N</span></td>
                        <td class="number">-0.19 <span class='trend-symbol trend-new'>N</span></td>
                        <td class="number">13</td>
                        <td class="number">$100.00</td>
                        <td class="number">9.0%</td>
                        <td class="number">23</td>
                        <td class="text">STRONG_BUY</td>
                        <td class="number"></td>
                        <td class="text"></td>
                    </tr>
                
                    <tr>
                        <td class="text">EVH</td>
                        <td class="text">Evolent Health Inc.</td>
                        <td class="number">0.00 <span class='trend-symbol trend-new'>N</span></td>
                        <td class="number">0.18 <span class='trend-symbol trend-new'>N</span></td>
                        <td class="number">4</td>
                        <td class="number">$15.00</td>
                        <td class="number">48.6%</td>
                        <td class="number">15</td>
                        <td class="text">STRONG_BUY</td>
                        <td class="number"></td>
                        <td class="text"></td>
                    </tr>
                
                    <tr>
                        <td class="text">FSLR</td>
                        <td class="text">First Solar Inc.</td>
                        <td class="number">-0.91 <span class='trend-symbol trend-new'>N</span></td>
                        <td class="number">-0.05 <span class='trend-symbol trend-new'>N</span></td>
                        <td class="number">16</td>
                        <td class="number">$273.00</td>
                        <td class="number">69.2%</td>
                        <td class="number">35</td>
                        <td class="text">BUY</td>
                        <td class="number"></td>
                        <td class="text"></td>
                    </tr>
                
                    <tr>
                        <td class="text">G</td>
                        <td class="text">Assicurazioni Generali S.p.A.</td>
                        <td class="number"></td>
                        <td class="number">0.13 <span class='trend-symbol trend-new'>N</span></td>
                        <td class="number">9</td>
                        <td class="number">$58.00</td>
                        <td class="number">5.0%</td>
                        <td class="number">9</td>
                        <td class="text">BUY</td>
                        <td class="number"></td>
                        <td class="text"></td>
                    </tr>
                
                    <tr>
                        <td class="text">GOOGL</td>
                        <td class="text">Alphabet Inc.</td>
                        <td class="number">0.03 <span class='trend-symbol trend-new'>N</span></td>
                        <td class="number">-0.09 <span class='trend-symbol trend-new'>N</span></td>
                        <td class="number">246</td>
                        <td class="number">$220.00</td>
                        <td class="number">19.3%</td>
                        <td class="number">48</td>
                        <td class="text">BUY</td>
                        <td class="number"></td>
                        <td class="text"></td>
                    </tr>
                
                    <tr>
                        <td class="text">GPCR</td>
                        <td class="text">Structure Therapeutics Inc.</td>
                        <td class="number">0.42 <span class='trend-symbol trend-new'>N</span></td>
                        <td class="number">0.21 <span class='trend-symbol trend-new'>N</span></td>
                        <td class="number">2</td>
                        <td class="number">$82.00</td>
                        <td class="number">239.8%</td>
                        <td class="number">13</td>
                        <td class="text">STRONG_BUY</td>
                        <td class="number"></td>
                        <td class="text"></td>
                    </tr>
                
                    <tr>
                        <td class="text">HAL</td>
                        <td class="text">Halliburton Company</td>
                        <td class="number">0.33 <span class='trend-symbol trend-new'>N</span></td>
                        <td class="number">-0.08 <span class='trend-symbol trend-new'>N</span></td>
                        <td class="number">23</td>
                        <td class="number">$34.00</td>
                        <td class="number">26.5%</td>
                        <td class="number">28</td>
                        <td class="text">BUY</td>
                        <td class="number"></td>
                        <td class="text"></td>
                    </tr>
                
                    <tr>
                        <td class="text">HBM</td>
                        <td class="text">Hudbay Minerals Inc.</td>
                        <td class="number">0.00 <span class='trend-symbol trend-new'>N</span></td>
                        <td class="number">0.00 <span class='trend-symbol trend-new'>N</span></td>
                        <td class="number">1</td>
                        <td class="number">$13.75</td>
                        <td class="number">52.7%</td>
                        <td class="number">2</td>
                        <td class="text">STRONG_BUY</td>
                        <td class="number"></td>
                        <td class="text"></td>
                    </tr>
                
                    <tr>
                        <td class="text">HQY</td>
                        <td class="text">HealthEquity Inc.</td>
                        <td class="number"></td>
                        <td class="number">0.02 <span class='trend-symbol trend-new'>N</span></td>
                        <td class="number">8</td>
                        <td class="number">$113.00</td>
                        <td class="number">0.3%</td>
                        <td class="number">14</td>
                        <td class="text">STRONG_BUY</td>
                        <td class="number"></td>
                        <td class="text"></td>
                    </tr>
                
                    <tr>
                        <td class="text">IDYA</td>
                        <td class="text">IDEAYA Biosciences Inc.</td>
                        <td class="number"></td>
                        <td class="number">0.00 <span class='trend-symbol trend-new'>N</span></td>
                        <td class="number">4</td>
                        <td class="number">$53.50</td>
                        <td class="number">153.8%</td>
                        <td class="number">14</td>
                        <td class="text">STRONG_BUY</td>
                        <td class="number"></td>
                        <td class="text"></td>
                    </tr>
                
                    <tr>
                        <td class="text">IMVT</td>
                        <td class="text">Immunovant Inc.</td>
                        <td class="number"></td>
                        <td class="number">-0.53 <span class='trend-symbol trend-new'>N</span></td>
                        <td class="number">1</td>
                        <td class="number">$50.50</td>
                        <td class="number">139.7%</td>
                        <td class="number">12</td>
                        <td class="text">STRONG_BUY</td>
                        <td class="number"></td>
                        <td class="text"></td>
                    </tr>
                
                    <tr>
                        <td class="text">INSW</td>
                        <td class="text">International Seaways Inc.</td>
                        <td class="number">0.53 <span class='trend-symbol trend-new'>N</span></td>
                        <td class="number">0.18 <span class='trend-symbol trend-new'>N</span></td>
                        <td class="number">4</td>
                        <td class="number">$58.00</td>
                        <td class="number">48.9%</td>
                        <td class="number">8</td>
                        <td class="text">STRONG_BUY</td>
                        <td class="number"></td>
                        <td class="text"></td>
                    </tr>
                
                    <tr>
                        <td class="text">LKQ</td>
                        <td class="text">LKQ Corporation</td>
                        <td class="number">0.01 <span class='trend-symbol trend-new'>N</span></td>
                        <td class="number">-0.18 <span class='trend-symbol trend-new'>N</span></td>
                        <td class="number">5</td>
                        <td class="number">$50.00</td>
                        <td class="number">27.5%</td>
                        <td class="number">9</td>
                        <td class="text">BUY</td>
                        <td class="number"></td>
                        <td class="text"></td>
                    </tr>
                
                    <tr>
                        <td class="text">LVO</td>
                        <td class="text">LiveOne Inc.</td>
                        <td class="number">0.00 <span class='trend-symbol trend-new'>N</span></td>
                        <td class="number">0.52 <span class='trend-symbol trend-new'>N</span></td>
                        <td class="number">5</td>
                        <td class="number">$3.00</td>
                        <td class="number">246.9%</td>
                        <td class="number">5</td>
                        <td class="text">STRONG_BUY</td>
                        <td class="number"></td>
                        <td class="text"></td>
                    </tr>
                
                    <tr>
                        <td class="text">LW</td>
                        <td class="text">Lamb Weston Holdings Inc.</td>
                        <td class="number">-0.01 <span class='trend-symbol trend-new'>N</span></td>
                        <td class="number">0.09 <span class='trend-symbol trend-new'>N</span></td>
                        <td class="number">9</td>
                        <td class="number">$68.00</td>
                        <td class="number">17.1%</td>
                        <td class="number">14</td>
                        <td class="text">BUY</td>
                        <td class="number"></td>
                        <td class="text"></td>
                    </tr>
                
                    <tr>
                        <td class="text">MA</td>
                        <td class="text">Mastercard Incorporated</td>
                        <td class="number">-0.03 <span class='trend-symbol trend-new'>N</span></td>
                        <td class="number">0.19 <span class='trend-symbol trend-new'>N</span></td>
                        <td class="number">59</td>
                        <td class="number">$626.50</td>
                        <td class="number">11.2%</td>
                        <td class="number">36</td>
                        <td class="text">BUY</td>
                        <td class="number"></td>
                        <td class="text"></td>
                    </tr>
                
                    <tr>
                        <td class="text">MDLZ</td>
                        <td class="text">Mondelez International Inc.</td>
                        <td class="number">0.10 <span class='trend-symbol trend-new'>N</span></td>
                        <td class="number">-0.02 <span class='trend-symbol trend-new'>N</span></td>
                        <td class="number">29</td>
                        <td class="number">$66.00</td>
                        <td class="number">7.6%</td>
                        <td class="number">24</td>
                        <td class="text">BUY</td>
                        <td class="number"></td>
                        <td class="text"></td>
                    </tr>
                
                    <tr>
                        <td class="text">MDXG</td>
                        <td class="text">MiMedx Group Inc.</td>
                        <td class="number"></td>
                        <td class="number">0.00 <span class='trend-symbol trend-new'>N</span></td>
                        <td class="number">1</td>
                        <td class="number">$13.00</td>
                        <td class="number">56.6%</td>
                        <td class="number">5</td>
                        <td class="text">NONE</td>
                        <td class="number"></td>
                        <td class="text"></td>
                    </tr>
                
                    <tr>
                        <td class="text">META</td>
                        <td class="text">Meta Platforms Inc.</td>
                        <td class="number">0.01 <span class='trend-symbol trend-new'>N</span></td>
                        <td class="number">0.05 <span class='trend-symbol trend-new'>N</span></td>
                        <td class="number">249</td>
                        <td class="number">$772.50</td>
                        <td class="number">7.6%</td>
                        <td class="number">60</td>
                        <td class="text">STRONG_BUY</td>
                        <td class="number"></td>
                        <td class="text"></td>
                    </tr>
                
                    <tr>
                        <td class="text">MNMD</td>
                        <td class="text">Mind Medicine (MindMed) Inc.</td>
                        <td class="number"></td>
                        <td class="number">0.08 <span class='trend-symbol trend-new'>N</span></td>
                        <td class="number">4</td>
                        <td class="number">$20.50</td>
                        <td class="number">127.8%</td>
                        <td class="number">10</td>
                        <td class="text">NONE</td>
                        <td class="number"></td>
                        <td class="text"></td>
                    </tr>
                
                    <tr>
                        <td class="text">MRVL</td>
                        <td class="text">Marvell Technology Inc.</td>
                        <td class="number">-0.09 <span class='trend-symbol trend-new'>N</span></td>
                        <td class="number">0.08 <span class='trend-symbol trend-new'>N</span></td>
                        <td class="number">48</td>
                        <td class="number">$130.00</td>
                        <td class="number">21.3%</td>
                        <td class="number">34</td>
                        <td class="text">STRONG_BUY</td>
                        <td class="number"></td>
                        <td class="text"></td>
                    </tr>
                
                    <tr>
                        <td class="text">MSFT</td>
                        <td class="text">Microsoft Corporation</td>
                        <td class="number">-0.01 <span class='trend-symbol trend-new'>N</span></td>
                        <td class="number">-0.02 <span class='trend-symbol trend-new'>N</span></td>
                        <td class="number">250</td>
                        <td class="number">$500.00</td>
                        <td class="number">22.3%</td>
                        <td class="number">50</td>
                        <td class="text">STRONG_BUY</td>
                        <td class="number"></td>
                        <td class="text"></td>
                    </tr>
                
                    <tr>
                        <td class="text">MU</td>
                        <td class="text">Micron Technology Inc.</td>
                        <td class="number">0.06 <span class='trend-symbol trend-new'>N</span></td>
                        <td class="number">-0.09 <span class='trend-symbol trend-new'>N</span></td>
                        <td class="number">97</td>
                        <td class="number">$125.00</td>
                        <td class="number">18.7%</td>
                        <td class="number">32</td>
                        <td class="text">BUY</td>
                        <td class="number"></td>
                        <td class="text"></td>
                    </tr>
                
                    <tr>
                        <td class="text">NVDA</td>
                        <td class="text">NVIDIA Corporation</td>
                        <td class="number">-0.00 <span class='trend-symbol trend-new'>N</span></td>
                        <td class="number">0.01 <span class='trend-symbol trend-new'>N</span></td>
                        <td class="number">249</td>
                        <td class="number">$175.00</td>
                        <td class="number">24.2%</td>
                        <td class="number">54</td>
                        <td class="text">STRONG_BUY</td>
                        <td class="number"></td>
                        <td class="text"></td>
                    </tr>
                
                    <tr>
                        <td class="text">PACS</td>
                        <td class="text">PACS Group Inc.</td>
                        <td class="number"></td>
                        <td class="number">-0.47 <span class='trend-symbol trend-new'>N</span></td>
                        <td class="number">2</td>
                        <td class="number">$32.00</td>
                        <td class="number">136.5%</td>
                        <td class="number">5</td>
                        <td class="text">BUY</td>
                        <td class="number"></td>
                        <td class="text"></td>
                    </tr>
                
                    <tr>
                        <td class="text">PFGC</td>
                        <td class="text">Performance Food Group Company</td>
                        <td class="number"></td>
                        <td class="number">-0.01 <span class='trend-symbol trend-new'>N</span></td>
                        <td class="number">6</td>
                        <td class="number">$102.00</td>
                        <td class="number">16.3%</td>
                        <td class="number">13</td>
                        <td class="text">BUY</td>
                        <td class="number"></td>
                        <td class="text"></td>
                    </tr>
                
                    <tr>
                        <td class="text">PRU</td>
                        <td class="text">Prudential Financial Inc.</td>
                        <td class="number">0.50 <span class='trend-symbol trend-new'>N</span></td>
                        <td class="number">0.09 <span class='trend-symbol trend-new'>N</span></td>
                        <td class="number">29</td>
                        <td class="number">$128.00</td>
                        <td class="number">15.2%</td>
                        <td class="number">13</td>
                        <td class="text">HOLD</td>
                        <td class="number"></td>
                        <td class="text"></td>
                    </tr>
                
                    <tr>
                        <td class="text">RCI</td>
                        <td class="text">Rogers Communications Inc.</td>
                        <td class="number">0.11 <span class='trend-symbol trend-new'>N</span></td>
                        <td class="number">-0.14 <span class='trend-symbol trend-new'>N</span></td>
                        <td class="number">6</td>
                        <td class="number">$38.52</td>
                        <td class="number">37.2%</td>
                        <td class="number">5</td>
                        <td class="text">BUY</td>
                        <td class="number"></td>
                        <td class="text"></td>
                    </tr>
                
                    <tr>
                        <td class="text">RCKT</td>
                        <td class="text">Rocket Pharmaceuticals Inc.</td>
                        <td class="number">0.77 <span class='trend-symbol trend-new'>N</span></td>
                        <td class="number">0.77 <span class='trend-symbol trend-new'>N</span></td>
                        <td class="number">1</td>
                        <td class="number">$39.00</td>
                        <td class="number">256.5%</td>
                        <td class="number">15</td>
                        <td class="text">STRONG_BUY</td>
                        <td class="number"></td>
                        <td class="text"></td>
                    </tr>
                
                    <tr>
                        <td class="text">SHOP</td>
                        <td class="text">Shopify Inc.</td>
                        <td class="number">0.32 <span class='trend-symbol trend-new'>N</span></td>
                        <td class="number">0.09 <span class='trend-symbol trend-new'>N</span></td>
                        <td class="number">37</td>
                        <td class="number">$135.50</td>
                        <td class="number">6.6%</td>
                        <td class="number">46</td>
                        <td class="text">BUY</td>
                        <td class="number"></td>
                        <td class="text"></td>
                    </tr>
                
                    <tr>
                        <td class="text">SLB</td>
                        <td class="text">Schlumberger Limited</td>
                        <td class="number">0.37 <span class='trend-symbol trend-new'>N</span></td>
                        <td class="number">0.16 <span class='trend-symbol trend-new'>N</span></td>
                        <td class="number">41</td>
                        <td class="number">$54.00</td>
                        <td class="number">26.9%</td>
                        <td class="number">31</td>
                        <td class="text">BUY</td>
                        <td class="number"></td>
                        <td class="text"></td>
                    </tr>
                
                    <tr>
                        <td class="text">SLP</td>
                        <td class="text">Simulations Plus Inc.</td>
                        <td class="number"></td>
                        <td class="number">0.15 <span class='trend-symbol trend-new'>N</span></td>
                        <td class="number">3</td>
                        <td class="number">$50.00</td>
                        <td class="number">37.3%</td>
                        <td class="number">5</td>
                        <td class="text">STRONG_BUY</td>
                        <td class="number"></td>
                        <td class="text"></td>
                    </tr>
                
                    <tr>
                        <td class="text">SMCI</td>
                        <td class="text">Super Micro Computer Inc.</td>
                        <td class="number">-0.08 <span class='trend-symbol trend-new'>N</span></td>
                        <td class="number">-0.03 <span class='trend-symbol trend-new'>N</span></td>
                        <td class="number">87</td>
                        <td class="number">$40.00</td>
                        <td class="number">-24.7%</td>
                        <td class="number">11</td>
                        <td class="text">HOLD</td>
                        <td class="number"></td>
                        <td class="text"></td>
                    </tr>
                
                    <tr>
                        <td class="text">SNDX</td>
                        <td class="text">Syndax Pharmaceuticals Inc.</td>
                        <td class="number"></td>
                        <td class="number">-0.32 <span class='trend-symbol trend-new'>N</span></td>
                        <td class="number">3</td>
                        <td class="number">$36.00</td>
                        <td class="number">145.9%</td>
                        <td class="number">13</td>
                        <td class="text">STRONG_BUY</td>
                        <td class="number"></td>
                        <td class="text"></td>
                    </tr>
                
                    <tr>
                        <td class="text">SPB</td>
                        <td class="text">Superior Plus Corp.</td>
                        <td class="number"></td>
                        <td class="number">0.18 <span class='trend-symbol trend-new'>N</span></td>
                        <td class="number">7</td>
                        <td class="number">$105.50</td>
                        <td class="number">34.0%</td>
                        <td class="number">8</td>
                        <td class="text">BUY</td>
                        <td class="number"></td>
                        <td class="text"></td>
                    </tr>
                
                    <tr>
                        <td class="text">STZ</td>
                        <td class="text">Constellation Brands Inc.</td>
                        <td class="number">0.01 <span class='trend-symbol trend-new'>N</span></td>
                        <td class="number">-0.21 <span class='trend-symbol trend-new'>N</span></td>
                        <td class="number">36</td>
                        <td class="number">$240.00</td>
                        <td class="number">40.7%</td>
                        <td class="number">24</td>
                        <td class="text">BUY</td>
                        <td class="number"></td>
                        <td class="text"></td>
                    </tr>
                
                    <tr>
                        <td class="text">TCOM</td>
                        <td class="text">Trip.com Group Limited</td>
                        <td class="number">-0.21 <span class='trend-symbol trend-new'>N</span></td>
                        <td class="number">0.13 <span class='trend-symbol trend-new'>N</span></td>
                        <td class="number">8</td>
                        <td class="number">$77.45</td>
                        <td class="number">15.0%</td>
                        <td class="number">30</td>
                        <td class="text">STRONG_BUY</td>
                        <td class="number"></td>
                        <td class="text"></td>
                    </tr>
                
                    <tr>
                        <td class="text">TNC</td>
                        <td class="text">Tennant Company</td>
                        <td class="number"></td>
                        <td class="number">0.00 <span class='trend-symbol trend-new'>N</span></td>
                        <td class="number">1</td>
                        <td class="number">$125.00</td>
                        <td class="number">47.3%</td>
                        <td class="number">3</td>
                        <td class="text">STRONG_BUY</td>
                        <td class="number"></td>
                        <td class="text"></td>
                    </tr>
                
                    <tr>
                        <td class="text">TRVG</td>
                        <td class="text">trivago N.V.</td>
                        <td class="number"></td>
                        <td class="number">0.12 <span class='trend-symbol trend-new'>N</span></td>
                        <td class="number">3</td>
                        <td class="number">$3.32</td>
                        <td class="number">-15.0%</td>
                        <td class="number">6</td>
                        <td class="text">HOLD</td>
                        <td class="number"></td>
                        <td class="text"></td>
                    </tr>
                
                    <tr>
                        <td class="text">TSLA</td>
                        <td class="text">Tesla Inc.</td>
                        <td class="number">-0.10 <span class='trend-symbol trend-new'>N</span></td>
                        <td class="number">-0.17 <span class='trend-symbol trend-new'>N</span></td>
                        <td class="number">250</td>
                        <td class="number">$359.00</td>
                        <td class="number">0.6%</td>
                        <td class="number">42</td>
                        <td class="text">HOLD</td>
                        <td class="number"></td>
                        <td class="text"></td>
                    </tr>
                
                    <tr>
                        <td class="text">TWLO</td>
                        <td class="text">Twilio Inc.</td>
                        <td class="number">0.12 <span class='trend-symbol trend-new'>N</span></td>
                        <td class="number">0.19 <span class='trend-symbol trend-new'>N</span></td>
                        <td class="number">21</td>
                        <td class="number">$144.00</td>
                        <td class="number">17.2%</td>
                        <td class="number">27</td>
                        <td class="text">BUY</td>
                        <td class="number"></td>
                        <td class="text"></td>
                    </tr>
                
                    <tr>
                        <td class="text">TX</td>
                        <td class="text">Ternium S.A.</td>
                        <td class="number"></td>
                        <td class="number">0.00 <span class='trend-symbol trend-new'>N</span></td>
                        <td class="number">1</td>
                        <td class="number">$40.00</td>
                        <td class="number">28.0%</td>
                        <td class="number">11</td>
                        <td class="text">BUY</td>
                        <td class="number"></td>
                        <td class="text"></td>
                    </tr>
                
                    <tr>
                        <td class="text">UAL</td>
                        <td class="text">United Airlines Holdings Inc.</td>
                        <td class="number">-0.15 <span class='trend-symbol trend-new'>N</span></td>
                        <td class="number">0.04 <span class='trend-symbol trend-new'>N</span></td>
                        <td class="number">51</td>
                        <td class="number">$130.00</td>
                        <td class="number">22.7%</td>
                        <td class="number">23</td>
                        <td class="text">STRONG_BUY</td>
                        <td class="number"></td>
                        <td class="text"></td>
                    </tr>
                
                    <tr>
                        <td class="text">UBER</td>
                        <td class="text">Uber Technologies Inc.</td>
                        <td class="number">-0.08 <span class='trend-symbol trend-new'>N</span></td>
                        <td class="number">-0.12 <span class='trend-symbol trend-new'>N</span></td>
                        <td class="number">112</td>
                        <td class="number">$90.00</td>
                        <td class="number">11.1%</td>
                        <td class="number">50</td>
                        <td class="text">BUY</td>
                        <td class="number"></td>
                        <td class="text"></td>
                    </tr>
                
                    <tr>
                        <td class="text">UPWK</td>
                        <td class="text">Upwork Inc.</td>
                        <td class="number">0.08 <span class='trend-symbol trend-new'>N</span></td>
                        <td class="number">0.02 <span class='trend-symbol trend-new'>N</span></td>
                        <td class="number">8</td>
                        <td class="number">$19.00</td>
                        <td class="number">16.8%</td>
                        <td class="number">11</td>
                        <td class="text">BUY</td>
                        <td class="number"></td>
                        <td class="text"></td>
                    </tr>
                
                    <tr>
                        <td class="text">UTZ</td>
                        <td class="text">Utz Brands Inc.</td>
                        <td class="number"></td>
                        <td class="number">-0.29 <span class='trend-symbol trend-new'>N</span></td>
                        <td class="number">2</td>
                        <td class="number">$18.00</td>
                        <td class="number">36.1%</td>
                        <td class="number">10</td>
                        <td class="text">BUY</td>
                        <td class="number"></td>
                        <td class="text"></td>
                    </tr>
                
                    <tr>
                        <td class="text">WELL</td>
                        <td class="text">WELL Health Technologies Corp.</td>
                        <td class="number">0.07 <span class='trend-symbol trend-new'>N</span></td>
                        <td class="number">0.06 <span class='trend-symbol trend-new'>N</span></td>
                        <td class="number">28</td>
                        <td class="number">$147.00</td>
                        <td class="number">-2.4%</td>
                        <td class="number">19</td>
                        <td class="text">BUY</td>
                        <td class="number"></td>
                        <td class="text"></td>
                    </tr>
                
                    <tr>
                        <td class="text">XPO</td>
                        <td class="text">XPO Inc.</td>
                        <td class="number">0.20 <span class='trend-symbol trend-new'>N</span></td>
                        <td class="number">0.26 <span class='trend-symbol trend-new'>N</span></td>
                        <td class="number">7</td>
                        <td class="number">$166.50</td>
                        <td class="number">13.1%</td>
                        <td class="number">24</td>
                        <td class="text">BUY</td>
                        <td class="number"></td>
                        <td class="text"></td>
                    </tr>
                
                    </tbody>
                </table>
                
                <div class="section-header">Stocks with Missing Data</div>
                <table id="missing-data-table" class="display">
                    <thead>
                        <tr>
                            <th>Ticker</th>
                            <th>Company</th>
                            <th>Sector</th>
                            <th>Missing Data</th>
                        </tr>
                    </thead>
                    <tbody>
            
                    <tr>
                        <td>AAV</td>
                        <td>Advantage Energy Ltd.</td>
                        <td>Energy</td>
                        <td>Sentiment, Market Data</td>
                    </tr>
                
                    <tr>
                        <td>ADEN</td>
                        <td>ADENTRA Inc.</td>
                        <td>Industrial</td>
                        <td>Sentiment, Market Data</td>
                    </tr>
                
                    <tr>
                        <td>AGED</td>
                        <td>iShares Ageing Population ETF</td>
                        <td>ETF</td>
                        <td>Sentiment, Market Data</td>
                    </tr>
                
                    <tr>
                        <td>BDGI</td>
                        <td>Badger Infrastructure Solutions Ltd.</td>
                        <td>Industrial</td>
                        <td>Sentiment, Market Data</td>
                    </tr>
                
                    <tr>
                        <td>BRNG</td>
                        <td>WisdomTree Brent Oil</td>
                        <td>ETF</td>
                        <td>Sentiment, Market Data</td>
                    </tr>
                
                    <tr>
                        <td>CURA</td>
                        <td>Curaleaf Holdings Inc.</td>
                        <td>Healthcare</td>
                        <td>Sentiment, Market Data</td>
                    </tr>
                
                    <tr>
                        <td>DIRUN</td>
                        <td>Dream Industrial Real Estate Investment Trust</td>
                        <td>Real Estate</td>
                        <td>Sentiment, Market Data</td>
                    </tr>
                
                    <tr>
                        <td>EIF</td>
                        <td>Exchange Income Corporation</td>
                        <td>Industrial</td>
                        <td>Sentiment, Market Data</td>
                    </tr>
                
                    <tr>
                        <td>EMV</td>
                        <td>iShares MSCI EM Min Volatility ETF</td>
                        <td>ETF</td>
                        <td>Sentiment, Market Data</td>
                    </tr>
                
                    <tr>
                        <td>IMCR</td>
                        <td>Immunocore Holdings plc</td>
                        <td>Healthcare</td>
                        <td>Sentiment</td>
                    </tr>
                
                    <tr>
                        <td>IWDA</td>
                        <td>iShares Core MSCI World ETF</td>
                        <td>ETF</td>
                        <td>Sentiment, Market Data</td>
                    </tr>
                
                    <tr>
                        <td>KNT</td>
                        <td>K92 Mining Inc.</td>
                        <td>Basic Materials</td>
                        <td>Sentiment, Market Data</td>
                    </tr>
                
                    <tr>
                        <td>OGC</td>
                        <td>OceanaGold Corporation</td>
                        <td>Basic Materials</td>
                        <td>Sentiment, Market Data</td>
                    </tr>
                
                    <tr>
                        <td>RCIB</td>
                        <td>Rogers Communications Inc.</td>
                        <td>Communication Services</td>
                        <td>Sentiment, Market Data</td>
                    </tr>
                
                    <tr>
                        <td>RLX</td>
                        <td>RLX Technology Inc.</td>
                        <td>Consumer Defensive</td>
                        <td>Sentiment</td>
                    </tr>
                
                    <tr>
                        <td>RNO</td>
                        <td>Renault SA</td>
                        <td>Consumer Cyclical</td>
                        <td>Sentiment, Market Data</td>
                    </tr>
                
                    <tr>
                        <td>TSU</td>
                        <td>Trisura Group Ltd.</td>
                        <td>Financial Services</td>
                        <td>Sentiment, Market Data</td>
                    </tr>
                
                    <tr>
                        <td>WCP</td>
                        <td>Whitecap Resources Inc.</td>
                        <td>Energy</td>
                        <td>Sentiment, Market Data</td>
                    </tr>
                
                    </tbody>
                </table>
                <script>
                    $(document).ready(function() {
                        // Custom sorting function for sentiment columns
                        $.fn.dataTable.ext.type.order['sentiment-pre'] = function(data) {
                            // Handle empty or invalid values
                            if (!data || data === '') return -999999;
                            
                            // Extract the numeric value from the sentiment cell
                            // This will match both positive and negative numbers with decimals
                            let match = data.match(/([-+]?[0-9]*\.?[0-9]+)/);
                            if (!match) return -999999;
                            
                            // Convert to float and handle NaN
                            let value = parseFloat(match[0]);
                            return isNaN(value) ? -999999 : value;
                        };
                        
                        $('#sentiment-table').DataTable({
                            order: [[2, 'desc']],  // Sort by last week sentiment by default
                            pageLength: 25,
                            fixedHeader: true,
                            scrollY: '50vh',
                            scrollCollapse: true,
                            keys: true,
                            columnDefs: [
                                // Text columns
                                {
                                    targets: [0, 1, 8, 10],  // Ticker, Company, Recommendation, Trend
                                    type: 'string'
                                },
                                // Sentiment columns with custom sorting
                                { 
                                    type: 'sentiment',
                                    targets: [2, 3, 9],  // Last Week, Last Month, and Sentiment Change columns
                                    render: function(data, type, row) {
                                        if (type === 'sort') {
                                            let match = data.match(/([-+]?[0-9]*\.?[0-9]+)/);
                                            return match ? parseFloat(match[0]) : -999999;
                                        }
                                        return data;
                                    }
                                },
                                // Numeric columns
                                { 
                                    type: 'num',
                                    targets: [4, 5, 6, 7],  // Articles, Target Price, Potential Return, Analysts
                                    render: function(data, type, row) {
                                        if (type === 'sort') {
                                            return data.replace(/[$%,]/g, '') || -999999;
                                        }
                                        return data;
                                    }
                                }
                            ],
                            language: {
                                thousands: ","
                            }
                        });
                        
                        $('#missing-data-table').DataTable({
                            order: [[0, 'asc']],  // Sort by ticker by default
                            pageLength: 10,
                            scrollY: '30vh',
                            scrollCollapse: true
                        });
                        
                        // Focus search box with Ctrl+F
                        $(document).keydown(function(e) {
                            if (e.ctrlKey && e.keyCode == 70) {
                                e.preventDefault();
                                $('.dataTables_filter input').first().focus();
                            }
                        });
                    });
                </script>
            </body>
            </html>
            